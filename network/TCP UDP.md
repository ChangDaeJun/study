### 4계층 프로토콜
* MAC 주소와 IP주소는 각각 2계층 3계층을 담당하며, 데이터가 목적지를 정확히 찾아가기 위한 주소를 제공하지만, 4계층에서의 프로토콜은 목적이 조금 다르다.
* 여러 애플리케이션 프로세스 중 통신해야 할 목적지 프로세스를 찾아가고, 패킷의 순서를 잘 조합하여 원래의 데이터를 잘 만들기 위한 역할을 한다.
* 4계층에서 추가되는 정보는 시퀀스 번호, ACK 번호가 있으며, 상위 프로토콜의 지시자는 포트번호이다.

### 포트번호
* 포트 번호는 인터넷 주소 할당기구 IANA에 등록되고 관리되며, 1023번 이하는 정해진 포트가 있다.
* 그 외 다양한 애플리케이션 포트 번호 할당을 위해 registered Port 범위를 사용하며, 1024 ~ 49151이다.
* 동적, 사설, 임시 포트는 49152 ~ 65535이며, 이 범위의 포트는 IANA에 등록되어 사용되지 않는다.

### TCP
* 신뢰할 수 없는 공용망에서도 정보유실 없는 통신을 보장하기 위해 세션을 안전하게 연결하고, 데이터를 분할하며, 분할한 패킷이 잘 전송되었는지 확인한다.
* 패킷에 시퀀스 번호를 할당하고, 잘 전송되었는지 응답 번호를 보낸다.
* 윈도 사이즈 : 한번에 보낼 데이터의 크기, 네트워크 상황에 따라 사이즈 조절하는 것을 슬라이딩 윈도라고 한다.
* TCP 헤더에서 윈도 사이즈로 표현할 수 있는 최대 크기는 2^16이다.
* 현대 네트워크에서는 윈도 사이즈 크기 부족으로 헤더 사이즈를 늘리지 않고, 뒤의 숫자를 무시하는 방법으로 윈도 사이즈를 키워 통신한다.

### 3way handshake
* TCP 프로토콜에서 통신 전 통신 가능 여부를 미리 확인하는 사전작업을 의미한다. 3번 패킷을 주고받으면서 준비하기에 3웨이 핸드셰이크라고 부른다.
[이미지]
* <출처 : <https://sjlim5092.tistory.com/35>>

* 서버는 listen 상태로 접속을 기다린다.
* 클라이언트가 통신을 시도하기 위해 syn 패킷을 보내게 되고, 이 상태를 syn-sent 상태라 한다.
* 서버는 syn 패킷을 받아 syn-receive 상태가 되고, syn과 ack 패킷으로 응답한다.
* 서버의 응답을 받은 클라이언트는 syn-established 상태가 되고, 이에 대한 응답을 서버에 보낸다.
* 응답을 받은 서버는 established 상태가 되며, 이는 서버와 클라이언트 간의 연결이 성공적으로 완료되었음을 나타낸다.
* 3웨이 핸드쉐이크와 일반 통신을 구분하기 위해 헤더레 플래그 값을 추가하여 통신하게 된다
    * SYN : 연결 시작의 의미, 연결 시작 시 1을 표시하여 보낸다.
    * ACK : ack 번호가 유효할 경우 1로 표시하여 보낸다. 초기 syn이 아닌 모든 패킷은 기존 메시지에 대한 응답이기에, ack 플래그는 1로 표기된다.
    * FIN : 연결 종료 시 1로 표시된다. 정상적으로 양방향 종료 시 사용된다.
    * RST : 연결 종료 시 1로 표시된다. 강제 종료를 위해 일방적으로 끊기 위해 사용한다.
    * URG : 긴급 데이터 일 경우 1로 표시된다.
    * PSH : 서버 측에서 전송할 데이터가 없거나 데이터를 버퍼링 없이 응용 프로그램에 즉시 전달 할 것을 지시하기 위해 사용한다.

### UDP
* UDP는 TCP에 비해 헤더가 작은 편. 이는 데이터 전송을 보장하지 않기 때문에 가능하다.
* 주로 음성 데이터나, 실시간 스트리밍과 같이 시간과 민감한 프로토콜 또는 애플리케이션에 사용된다.